# $Id: Makefile,v 1.4 2014/06/21 03:15:07 fn6418 Exp $

PROJ_DIR=/home/mehedi/workspace/obesity

BIN_DIR=$(PROJ_DIR)/bin/$(BUILD_MODE)
OBJ_DIR=$(PROJ_DIR)/_obj/$(BUILD_MODE)
SRC_DIR=$(PROJ_DIR)/src

ifeq "$(BUILD_MODE)" "debug"
CXXOPT=-g -D_DEBUG -DHAVE_INLINE
endif

ifeq "$(BUILD_MODE)" "release"
CXXOPT=-Wall -O3 -DHAVE_INLINE
endif

CXX = g++
ILEMUR = -I/home/mehedi/lemur/include
LZLIB = -L/usr/lib64
LLEMUR = -L/home/mehedi/lemur/lib

CXXFLAGS = $(CXXOPT) -DPACKAGE_NAME=\"Lemur\" -DPACKAGE_TARNAME=\"lemur\" -DPACKAGE_VERSION=\"4.12\" -DPACKAGE_STRING=\"Lemur\ 4.12\" -DPACKAGE_BUGREPORT=\"project@lemurproject.org\" -DHAVE_LIBM=1 -DHAVE_LIBPTHREAD=1 -DHAVE_LIBZ=1 -DHAVE_NAMESPACES= -DISNAN_IN_NAMESPACE_STD= -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -D_FILE_OFFSET_BITS=64 -DHAVE_FSEEKO=1 -DHAVE_MKSTEMP=1 -DHAVE_EXT_ATOMICITY_H=1 -DP_NEEDS_GNU_CXX_NAMESPACE=1 $(ILEMUR)

CXXLIBS = -lm -lpthread
LDLEMUR = $(LLEMUR) -llemur $(LZLIP) -lz

$(OBJ_DIR)/%.o: $(SRC_DIR)/%.cpp
	$(CXX) $(CXXFLAGS) -o $@ -c $<
	
UTILS = $(OBJ_DIR)/Utils.o
DIR_READER = $(OBJ_DIR)/DirReader.o
FORM = $(OBJ_DIR)/Formatter.o
SPLIT = $(OBJ_DIR)/Splitter.o
LTA = $(OBJ_DIR)/LTA.o
COL_LTA = $(OBJ_DIR)/ColLTA.o
LTA_CLS = $(OBJ_DIR)/LTAClass.o
LAB_LDA = $(OBJ_DIR)/LabLDA.o
COL_LAB_LDA = $(OBJ_DIR)/ColLabLDA.o
MG_LAB_LDA = $(OBJ_DIR)/MGLabLDA.o
COL_MG_LAB_LDA = $(OBJ_DIR)/ColMGLabLDA.o

LDA_CLS = $(OBJ_DIR)/LDAClass.o
EVAL = $(OBJ_DIR)/Eval.o

FORM_OBJS = $(DIR_READER) $(UTILS) $(FORM)
SPLIT_OBJS = $(UTILS) $(SPLIT)
LTA_OBJS = $(UTILS) $(LTA) $(COL_LTA)
LTA_CLS_OBJS = $(UTILS) $(LTA_CLS)
LAB_LDA_OBJS = $(UTILS) $(LAB_LDA) $(COL_LAB_LDA)
MG_LAB_LDA_OBJS = $(UTILS) $(MG_LAB_LDA) $(COL_MG_LAB_LDA)
LDA_CLS_OBJS = $(UTILS) $(LDA_CLS)
EVAL_OBJS = $(DIR_READER) $(UTILS) $(EVAL)

FORM_BIN = $(BIN_DIR)/Formatter
SPLIT_BIN = $(BIN_DIR)/Splitter
LTA_BIN = $(BIN_DIR)/LTA
LTA_CLS_BIN = $(BIN_DIR)/LTAClass
LAB_LDA_BIN = $(BIN_DIR)/LabLDA
MG_LAB_LDA_BIN = $(BIN_DIR)/MGLabLDA
LDA_CLS_BIN = $(BIN_DIR)/LDAClass
EVAL_BIN = $(BIN_DIR)/Eval

all: $(FORM_BIN) $(SPLIT_BIN) $(LTA_BIN) $(LTA_CLS_BIN) $(LAB_LDA_BIN) $(MG_LAB_LDA_BIN) $(LDA_CLS_BIN) $(EVAL_BIN)

$(FORM_BIN): $(FORM_OBJS)
	$(CXX) $(CXXFLAGS) -o $@ $^ $(CXXLIBS) $(LDLEMUR)

$(SPLIT_BIN): $(SPLIT_OBJS)
	$(CXX) $(CXXFLAGS) -o $@ $^ $(CXXLIBS) $(LDLEMUR)

$(LTA_BIN): $(LTA_OBJS)
	$(CXX) $(CXXFLAGS) -o $@ $^ $(CXXLIBS)

$(LTA_CLS_BIN): $(LTA_CLS_OBJS)
	$(CXX) $(CXXFLAGS) -o $@ $^ $(CXXLIBS)

$(LAB_LDA_BIN): $(LAB_LDA_OBJS)
	$(CXX) $(CXXFLAGS) -o $@ $^ $(CXXLIBS)

$(MG_LAB_LDA_BIN): $(MG_LAB_LDA_OBJS)
	$(CXX) $(CXXFLAGS) -o $@ $^ $(CXXLIBS)

$(LDA_CLS_BIN): $(LDA_CLS_OBJS)
	$(CXX) $(CXXFLAGS) -o $@ $^ $(CXXLIBS)
		
$(EVAL_BIN): $(EVAL_OBJS)
	$(CXX) $(CXXFLAGS) -o $@ $^ $(CXXLIBS)
	
clean:
	rm -f $(FORM_BIN) $(FORM_OBJS) $(SPLIT_BIN) $(SPLIT_OBJS) $(LTA_BIN) $(LTA_OBJS) $(LTA_CLS_BIN) $(LTA_CLS_OBJS) \
	      $(LAB_LDA_BIN) $(LAB_LDA_OBJS) $(MG_LAB_LDA_BIN) $(MG_LAB_LDA_OBJS) $(LDA_CLS_BIN) $(LDA_CLS_OBJS) $(EVAL_BIN) $(EVAL_OBJS)
